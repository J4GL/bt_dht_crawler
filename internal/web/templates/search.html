<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DHT Crawler Search</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 40px 0; }
        h1 { font-size: 2.5rem; margin-bottom: 10px; color: #00d4ff; }
        .stats { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-bottom: 30px; font-size: 0.9rem; color: #888; }
        .stat { background: #252547; padding: 8px 16px; border-radius: 20px; }
        .search-form { display: flex; gap: 10px; margin-bottom: 30px; }
        .search-form input { flex: 1; padding: 15px; font-size: 1.1rem; border: none; border-radius: 8px; background: #252547; color: #fff; }
        .search-form input::placeholder { color: #666; }
        .search-form button { padding: 15px 30px; font-size: 1.1rem; border: none; border-radius: 8px; background: #00d4ff; color: #1a1a2e; cursor: pointer; font-weight: bold; transition: background 0.2s; }
        .search-form button:hover { background: #00b8e6; }
        .results-count { color: #888; margin-bottom: 20px; }
        .result { background: #252547; padding: 20px; border-radius: 8px; margin-bottom: 15px; transition: transform 0.1s; }
        .result:hover { transform: translateX(5px); }
        .result-name { font-size: 1.2rem; color: #00d4ff; margin-bottom: 10px; word-break: break-all; }
        .result-name b { background: #00d4ff33; padding: 0 2px; border-radius: 2px; }
        .result-meta { display: flex; gap: 20px; color: #888; font-size: 0.9rem; }
        .result-hash { font-family: monospace; font-size: 0.8rem; color: #666; margin-top: 10px; word-break: break-all; }
        .pagination { display: flex; justify-content: center; gap: 10px; margin-top: 30px; }
        .pagination a { padding: 10px 20px; background: #252547; color: #00d4ff; text-decoration: none; border-radius: 5px; transition: background 0.2s; }
        .pagination a:hover { background: #303060; }
        .magnet-link { color: #00d4ff; text-decoration: none; font-size: 0.9rem; }
        .magnet-link:hover { text-decoration: underline; }
        .no-results { text-align: center; color: #666; padding: 40px; }
        @media (max-width: 600px) {
            .search-form { flex-direction: column; }
            .result-meta { flex-direction: column; gap: 5px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DHT Crawler</h1>
            <div class="stats">
                <span class="stat">Torrents: {{formatNumber .Stats.TotalTorrents}}</span>
                <span class="stat">Hashes: {{formatNumber .Stats.TotalHashes}}</span>
                <span class="stat">DHT Nodes: {{.Stats.DHTNodesActive}}</span>
                <span class="stat">Downloads: {{formatNumber .Stats.DownloadSuccess}}</span>
                <span class="stat">Uptime: {{formatDuration .Stats.Uptime}}</span>
            </div>
        </header>

        <form class="search-form" action="/search" method="GET">
            <input type="text" name="q" placeholder="Search torrents... (fuzzy search supported)" value="{{.Query}}" autofocus>
            <button type="submit">Search</button>
        </form>

        {{if .Query}}
            <div class="results-count">Found {{.Total}} results for "{{.Query}}"</div>

            {{if .Results}}
                {{range .Results}}
                <div class="result">
                    <div class="result-name">{{if .NameHighlight}}{{.NameHighlight}}{{else}}{{.Name}}{{end}}</div>
                    <div class="result-meta">
                        <span>Size: {{formatSize .Size}}</span>
                        <span>Files: {{.FileCount}}</span>
                        <span>Requests: {{.ReqCount}}</span>
                    </div>
                    <div class="result-hash">
                        <a class="magnet-link" href="magnet:?xt=urn:btih:{{.InfoHash}}&dn={{.Name}}">magnet:?xt=urn:btih:{{.InfoHash}}</a>
                    </div>
                </div>
                {{end}}

                <div class="pagination">
                    {{if .HasPrev}}<a href="/search?q={{.Query}}&page={{.PrevPage}}">&larr; Previous</a>{{end}}
                    <span style="color: #666; padding: 10px;">Page {{.Page}} of {{.TotalPages}}</span>
                    {{if .HasNext}}<a href="/search?q={{.Query}}&page={{.NextPage}}">Next &rarr;</a>{{end}}
                </div>
            {{else}}
                <div class="no-results">No results found. Try a different search term.</div>
            {{end}}
        {{end}}
    </div>
</body>
</html>
